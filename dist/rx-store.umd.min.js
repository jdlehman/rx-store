!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define("rx-store",["exports"],r):r(t.RxStore=t.RxStore||{})}(this,function(t){"use strict";function r(t,r){return r={exports:{}},t(r,r.exports),r.exports}function e(t){return"function"==typeof t}function o(t){return null!=t&&"object"===("undefined"==typeof t?"undefined":h(t))}function n(){try{return b.apply(this,arguments)}catch(t){return x.errorObject.e=t,x.errorObject}}function i(t){return b=t,n}function s(t,r,e){if(t){if(t instanceof X.Subscriber)return t;if(t[Z.$$rxSubscriber])return t[Z.$$rxSubscriber]()}return t||r||e?new X.Subscriber(t,r,e):new X.Subscriber(tt.empty)}function c(t){var r,e=t.Symbol;return"function"==typeof e?e.observable?r=e.observable:(r=e("observable"),e.observable=r):r="@@observable",r}function u(t,r){var e=new Jt(r);return{state$:e,dispatch:function(r){return e.next(t(e.value,r))},subscribe:function(){return e.subscribe.apply(e,arguments)}}}var b,p="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},f=r(function(t,r){if(r.root="object"==("undefined"==typeof window?"undefined":h(window))&&window.window===window&&window||"object"==("undefined"==typeof self?"undefined":h(self))&&self.self===self&&self||"object"==h(p)&&p.global===p&&p,!r.root)throw new Error("RxJS could not find any global context (window, self, global)")}),a=e,l={isFunction:a},y=Array.isArray||function(t){return t&&"number"==typeof t.length},d={isArray:y},w=o,_={isObject:w},v={e:{}},S={errorObject:v},x=S,E=i,m={tryCatch:E},O=p&&p.__extends||function(t,r){function e(){this.constructor=t}for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},j=function(t){function r(r){t.call(this),this.errors=r;var e=Error.call(this,r?r.length+" errors occurred during unsubscription:\n  "+r.map(function(t,r){return r+1+") "+t.toString()}).join("\n  "):"");this.name=e.name="UnsubscriptionError",this.stack=e.stack,this.message=e.message}return O(r,t),r}(Error),g=j,T={UnsubscriptionError:g},P=d,U=_,$=l,k=m,M=S,R=T,Y=function(){function t(t){this.closed=!1,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var t,r=!1;if(!this.closed){this.closed=!0;var e=this,o=e._unsubscribe,n=e._subscriptions;if(this._subscriptions=null,$.isFunction(o)){var i=k.tryCatch(o).call(this);i===M.errorObject&&(r=!0,(t=t||[]).push(M.errorObject.e))}if(P.isArray(n))for(var s=-1,c=n.length;++s<c;){var u=n[s];if(U.isObject(u)){var i=k.tryCatch(u.unsubscribe).call(u);if(i===M.errorObject){r=!0,t=t||[];var b=M.errorObject.e;b instanceof R.UnsubscriptionError?t=t.concat(b.errors):t.push(b)}}}if(r)throw new R.UnsubscriptionError(t)}},t.prototype.add=function(r){if(!r||r===t.EMPTY)return t.EMPTY;if(r===this)return this;var e=r;switch("undefined"==typeof r?"undefined":h(r)){case"function":e=new t(r);case"object":if(e.closed||"function"!=typeof e.unsubscribe)break;this.closed?e.unsubscribe():(this._subscriptions||(this._subscriptions=[])).push(e);break;default:throw new Error("unrecognized teardown "+r+" added to Subscription.")}return e},t.prototype.remove=function(r){if(null!=r&&r!==this&&r!==t.EMPTY){var e=this._subscriptions;if(e){var o=e.indexOf(r);o!==-1&&e.splice(o,1)}}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}(),V=Y,A={Subscription:V},F={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}},C={empty:F},z=f,J=z.root.Symbol,q="function"==typeof J&&"function"==typeof J.for?J.for("rxSubscriber"):"@@rxSubscriber",B={$$rxSubscriber:q},D=p&&p.__extends||function(t,r){function e(){this.constructor=t}for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},G=l,H=A,I=C,K=B,L=function(t){function r(e,o,n){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=I.empty;break;case 1:if(!e){this.destination=I.empty;break}if("object"===("undefined"==typeof e?"undefined":h(e))){e instanceof r?(this.destination=e,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new Q(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new Q(this,e,o,n)}}return D(r,t),r.prototype[K.$$rxSubscriber]=function(){return this},r.create=function(t,e,o){var n=new r(t,e,o);return n.syncErrorThrowable=!1,n},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r}(H.Subscription),N=L,Q=function(t){function r(r,e,o,n){t.call(this),this._parent=r;var i,s=this;G.isFunction(e)?i=e:e&&(s=e,i=e.next,o=e.error,n=e.complete,G.isFunction(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this)),this._context=s,this._next=i,this._error=o,this._complete=n}return D(r,t),r.prototype.next=function(t){if(!this.isStopped&&this._next){var r=this._parent;r.syncErrorThrowable?this.__tryOrSetError(r,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},r.prototype.error=function(t){if(!this.isStopped){var r=this._parent;if(this._error)r.syncErrorThrowable?(this.__tryOrSetError(r,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!r.syncErrorThrowable)throw this.unsubscribe(),t;r.syncErrorValue=t,r.syncErrorThrown=!0,this.unsubscribe()}}},r.prototype.complete=function(){if(!this.isStopped){var t=this._parent;this._complete?t.syncErrorThrowable?(this.__tryOrSetError(t,this._complete),this.unsubscribe()):(this.__tryOrUnsub(this._complete),this.unsubscribe()):this.unsubscribe()}},r.prototype.__tryOrUnsub=function(t,r){try{t.call(this._context,r)}catch(t){throw this.unsubscribe(),t}},r.prototype.__tryOrSetError=function(t,r,e){try{r.call(this._context,e)}catch(r){return t.syncErrorValue=r,t.syncErrorThrown=!0,!0}return!1},r.prototype._unsubscribe=function(){var t=this._parent;this._context=null,this._parent=null,t.unsubscribe()},r}(L),W={Subscriber:N},X=W,Z=B,tt=C,rt=s,et={toSubscriber:rt},ot=f,nt=c,it=c(ot.root),st={getSymbolObservable:nt,$$observable:it},ct=f,ut=et,bt=st,pt=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(r){var e=new t;return e.source=this,e.operator=r,e},t.prototype.subscribe=function(t,r,e){var o=this.operator,n=ut.toSubscriber(t,r,e);if(o?o.call(n,this):n.add(this._subscribe(n)),n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n},t.prototype.forEach=function(t,r){var e=this;if(r||(ct.root.Rx&&ct.root.Rx.config&&ct.root.Rx.config.Promise?r=ct.root.Rx.config.Promise:ct.root.Promise&&(r=ct.root.Promise)),!r)throw new Error("no Promise impl found");return new r(function(r,o){var n=e.subscribe(function(r){if(n)try{t(r)}catch(t){o(t),n.unsubscribe()}else t(r)},o,r)})},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[bt.$$observable]=function(){return this},t.create=function(r){return new t(r)},t}(),ht=pt,ft={Observable:ht},at=p&&p.__extends||function(t,r){function e(){this.constructor=t}for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},lt=function(t){function r(){var r=t.call(this,"object unsubscribed");this.name=r.name="ObjectUnsubscribedError",this.stack=r.stack,this.message=r.message}return at(r,t),r}(Error),yt=lt,dt={ObjectUnsubscribedError:yt},wt=p&&p.__extends||function(t,r){function e(){this.constructor=t}for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},_t=A,vt=function(t){function r(r,e){t.call(this),this.subject=r,this.subscriber=e,this.closed=!1}return wt(r,t),r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,r=t.observers;if(this.subject=null,r&&0!==r.length&&!t.isStopped&&!t.closed){var e=r.indexOf(this.subscriber);e!==-1&&r.splice(e,1)}}},r}(_t.Subscription),St=vt,xt={SubjectSubscription:St},Et=p&&p.__extends||function(t,r){function e(){this.constructor=t}for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},mt=ft,Ot=W,jt=A,gt=dt,Tt=xt,Pt=B,Ut=function(t){function r(r){t.call(this,r),this.destination=r}return Et(r,t),r}(Ot.Subscriber),$t=Ut,kt=function(t){function r(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return Et(r,t),r.prototype[Pt.$$rxSubscriber]=function(){return new Ut(this)},r.prototype.lift=function(t){var r=new Rt(this,this);return r.operator=t,r},r.prototype.next=function(t){if(this.closed)throw new gt.ObjectUnsubscribedError;if(!this.isStopped)for(var r=this.observers,e=r.length,o=r.slice(),n=0;n<e;n++)o[n].next(t)},r.prototype.error=function(t){if(this.closed)throw new gt.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var r=this.observers,e=r.length,o=r.slice(),n=0;n<e;n++)o[n].error(t);this.observers.length=0},r.prototype.complete=function(){if(this.closed)throw new gt.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,r=t.length,e=t.slice(),o=0;o<r;o++)e[o].complete();this.observers.length=0},r.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},r.prototype._subscribe=function(t){if(this.closed)throw new gt.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),jt.Subscription.EMPTY):this.isStopped?(t.complete(),jt.Subscription.EMPTY):(this.observers.push(t),new Tt.SubjectSubscription(this,t))},r.prototype.asObservable=function(){var t=new mt.Observable;return t.source=this,t},r.create=function(t,r){return new Rt(t,r)},r}(mt.Observable),Mt=kt,Rt=function(t){function r(r,e){t.call(this),this.destination=r,this.source=e}return Et(r,t),r.prototype.next=function(t){var r=this.destination;r&&r.next&&r.next(t)},r.prototype.error=function(t){var r=this.destination;r&&r.error&&this.destination.error(t)},r.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},r.prototype._subscribe=function(t){var r=this.source;return r?this.source.subscribe(t):jt.Subscription.EMPTY},r}(kt),Yt=Rt,Vt={SubjectSubscriber:$t,Subject:Mt,AnonymousSubject:Yt},At=p&&p.__extends||function(t,r){function e(){this.constructor=t}for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},Ft=Vt,Ct=dt,zt=function(t){function r(r){t.call(this),this._value=r}return At(r,t),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(r){var e=t.prototype._subscribe.call(this,r);return e&&!e.closed&&r.next(this._value),e},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Ct.ObjectUnsubscribedError;return this._value},r.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},r}(Ft.Subject),Jt=zt;t.createRxStore=u,Object.defineProperty(t,"__esModule",{value:!0})});
